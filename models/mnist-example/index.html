<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/model-zoo-demo/css/monokailight-syntax.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    
    
    <title>Simula Model Zoo | MNIST Example</title>
</head>
<body>


<nav class="navbar navbar-expand-md navbar-light bg-light py-4">  
    <div class="container">
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
            <a class="navbar-brand" href="http://smaeland.github.io/model-zoo-demo/">
                <img src="http://smaeland.github.io/model-zoo-demo/images/simula_main_small_RGB.png " alt="" height="42" class="d-inline-block" style="padding-bottom: 14px;">
                Model Zoo
                </a>
            <ul class="navbar-nav me-auto">
                <h5 style="margin-right: 4em">BETA</h5>
                
                    <li class="nav-item">
                        <a class="nav-link " href="/model-zoo-demo/"> Home</a>
                    </li>
                
                    <li class="nav-item">
                        <a class="nav-link " href="/model-zoo-demo/categories/"> Categories</a>
                    </li>
                
                    <li class="nav-item">
                        <a class="nav-link " href="/model-zoo-demo/tags/"> Tags</a>
                    </li>
                
                    <li class="nav-item">
                        <a class="nav-link " href="/model-zoo-demo/docs/"> How-to</a>
                    </li>
                
            </ul>
        </div>
        
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="btn btn-success" href="#">Submit a model</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="content">






<div class='container'>
    <div class="row mt-5">
        <h1>MNIST Example</h1>
            <br>
            <p class="lead">Example model for classifying handwritten digits in the MNIST dataset.</p>
        <div class="col-sm-9">
            
            <div class="card bg-light">
                <div class="card-body">
                    <h5>Download</h5>
                    <ul class="nav nav-tabs nav-fill " id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                          <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#files" type="button" role="tab">Files</button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#image" type="button" role="tab">Docker image</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#notebook" type="button" role="tab">Notebook</button>
                          </li>
                      </ul>
                      <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="files" role="tabpanel" aria-labelledby="home-tab">
                            <br>
                            <i>If the download does not start automatically, right-click and select "Save Link As..."</i>
                            <br><br>
                            
                                <a class="btn btn-primary" href="https://raw.githubusercontent.com/smaeland/model-zoo-mnist-example/main/requirements.txt" download><i class="bi bi-arrow-down"></i> requirements.txt</a>
                            
                            
                                <a class="btn btn-primary" href="https://github.com/smaeland/model-zoo-mnist-example/raw/main/cnn-model-v1.zip" download><i class="bi bi-arrow-down"></i> cnn-model-v1.zip</a>
                            
                            <br><br>
                            
                            <i>Or download using <code>wget</code>:</i>
                            <br>
                            <div class="highlight">
                                <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">wget https://raw.githubusercontent.com/smaeland/model-zoo-mnist-example/main/requirements.txt
wget https://github.com/smaeland/model-zoo-mnist-example/raw/main/cnn-model-v1.zip</code></pre>

                            </div>
                            
                        </div>
                        <div class="tab-pane fade" id="image" role="tabpanel">
                            <br>
                            
                            <a class="btn btn-primary disabled" href="#"><i>No image provided</i></a>
                            
                        </div>
                        <div class="tab-pane fade" id="notebook" role="tabpanel">
                            <br>
                            
                                <a class="btn btn-primary" href="https://colab.research.google.com/github/smaeland/model-zoo-mnist-example/blob/main/notebook.ipynb" download><i class="bi bi-journal-bookmark"></i> Launch Jupyter notebook</a>
                            
                        </div>
                      </div>
                </div>
            </div>
            <br>
            <p>This model serves as an example of how to download, run, and modify the
contributions in the Model Zoo. For additional examples and instructions,
consult the models' GitHub repository. The model is implemented in Keras.</p>
<p><img src="mnist-digits.png" alt="MNIST digits" title="MNIST digits"></p>
<h3 id="requirements">Requirements</h3>
<p>Install requirements using <code>pip</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">wget https://raw.githubusercontent.com/smaeland/model-zoo-mnist-example/main/requirements.txt
pip install -r requirements.txt
</code></pre></div><h3 id="download-the-model">Download the model</h3>
<p>The model is available as a zip file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">wget https://github.com/smaeland/model-zoo-mnist-example/raw/main/cnn-model-v1.zip
unzip cnn-model-v1.zip
</code></pre></div><p>Instantiate it by calling <code>load_model</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;cnn-model-v1&#39;</span><span class="p">)</span>
</code></pre></div><h3 id="download-example-data">Download example data</h3>
<p>The data is directly available through Keras:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</code></pre></div><h3 id="preprocessing">Preprocessing</h3>
<p>Model preprocessing involves scaling the images from [0, 255] to [0.0, 1.0].
Input data should have dimensions <code>(n_samples, 28, 28, 1)</code>. The example data
does not include the channel (last) dimension; use the snippet below to add it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;float32&#34;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&#34;float32&#34;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div><h3 id="run">Run</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">CategoricalAccuracy</span><span class="p">()</span>
<span class="n">acc</span><span class="o">.</span><span class="n">update_state</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="n">acc</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
 <span class="c1"># Accuracy: 0.991</span>
</code></pre></div><h3 id="modify">Modify</h3>
<p>Being implemented in Keras, it is easy to fine-tune and modify the model, by
following the <a href="https://keras.io/guides/transfer_learning/">Keras docs</a>. A
specific example is also given in the Jupyter <a href="https://github.com/smaeland/model-zoo-mnist-example/blob/main/run_model.ipynb">notebook</a>
in the models' GitHub repository.</p>

        </div>
        <div class="col-sm-3">
            




<div class="card">
    <div class="card-header">
        <h5>Metadata</h5>
    </div>
    <div class="card-body">
        <p class="card-text">
            <span class="bi bi-calendar-date"></span>
            <time datetime="2021-09-02"> Published Sep 2, 2021</time>
            <br>
                <div class="d-grid gap-2">
                
                    <a class="btn btn-primary" href="https://github.com/smaeland/model-zoo-mnist-example"><i class="bi bi-code-slash"></i> Code repository</a>
                
            </div>
            <br>
            <h5>Categories</h5>
            


    <span class="btn btn-sm btn-outline-primary tag-btn"><i class="bi bi-folder"></i> Computer vision</span>

    <span class="btn btn-sm btn-outline-primary tag-btn"><i class="bi bi-folder"></i> Examples</span>

            <br><br>
            <h5>Tags</h5>
            


    <span class="btn btn-sm btn-outline-success tag-btn"><i class="bi bi-tag"></i> CNN</span>

    <span class="btn btn-sm btn-outline-success tag-btn"><i class="bi bi-tag"></i> MNIST</span>

    <span class="btn btn-sm btn-outline-success tag-btn"><i class="bi bi-tag"></i> Python</span>

    <span class="btn btn-sm btn-outline-success tag-btn"><i class="bi bi-tag"></i> Keras</span>

        </p>
    </div>
</div>



        </div>
    </div>


</div>




        </div>
</body>
</html>
